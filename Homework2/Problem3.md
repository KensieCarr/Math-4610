# Homework 2

## Problem 3

### a. For
<p>
  $f(x) = \sqrt(x)$
</p>
use the derivative approximation to examine machine precision errors as *h* tends to zero. Then use the conjugate of the numerator 
to rewrite the derivative formula using the following steps:

**i.** multiply the numberator and denominator by the conjugate 
<p>
  $\left( \dfrac{\sqrt{x+h} - \sqrt{x}}{h} \times \dfrac{\sqrt{x+h} + \sqrt{x}}{\sqrt{x+h} + 
\sqrt{x}} \right)$
</p>

**ii.** simplify the expression, and
<p>
  $ \dfrac{x + h - x}{h(\sqrt{x+h} + x)} = \dfrac{h}{h(\sqrt{x+h} + x)} = \dfrac{1}{\sqrt{x+h} + x} $
</p>

**iii.** analyze the errors using the new form of the derivative
<pre>
Function:  f(x) = x^(1/2)
======================
h                  | exactSolution      | approx             | relError           | absError             
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
1.000000000        | 0.25               | 0.2360679775       | 5.572809e-02       | 1.393202e-02      
0.5000000000       | 0.25               | 0.2426406871       | 2.943725e-02       | 7.359313e-03      
0.2500000000       | 0.25               | 0.2462112512       | 1.515500e-02       | 3.788749e-03      
0.1250000000       | 0.25               | 0.2480768093       | 7.692763e-03       | 1.923191e-03      
0.06250000000      | 0.25               | 0.2490309932       | 3.876027e-03       | 9.690068e-04      
0.03125000000      | 0.25               | 0.2495136168       | 1.945533e-03       | 4.863832e-04      
0.01562500000      | 0.25               | 0.2497563351       | 9.746598e-04       | 2.436649e-04      
0.007812500000     | 0.25               | 0.2498780488       | 4.878050e-04       | 1.219512e-04      
0.003906250000     | 0.25               | 0.2499389946       | 2.440215e-04       | 6.100537e-05      
0.001953125000     | 0.25               | 0.2499694899       | 1.220405e-04       | 3.051013e-05      
0.0009765625000    | 0.25               | 0.2499847431       | 6.102771e-05       | 1.525693e-05      
0.0004882812500    | 0.25               | 0.2499923711       | 3.051572e-05       | 7.628929e-06      
0.0002441406250    | 0.25               | 0.2499961854       | 1.525832e-05       | 3.814581e-06      
0.0001220703125    | 0.25               | 0.2499980927       | 7.629278e-06       | 1.907320e-06      
0.00006103515625   | 0.25               | 0.2499990463       | 3.814668e-06       | 9.536670e-07      
0.00003051757813   | 0.25               | 0.2499995232       | 1.907349e-06       | 4.768372e-07      
0.00001525878906   | 0.25               | 0.2499997616       | 9.536743e-07       | 2.384186e-07      
0.000007629394531  | 0.25               | 0.2499998808       | 4.768372e-07       | 1.192093e-07      
0.000003814697266  | 0.25               | 0.2499999404       | 2.384186e-07       | 5.960464e-08      
0.000001907348633  | 0.25               | 0.2499999702       | 1.192093e-07       | 2.980232e-08      
9.536743164E-7     | 0.25               | 0.2499999851       | 5.960464e-08       | 1.490116e-08      
4.768371582E-7     | 0.25               | 0.2499999925       | 2.980232e-08       | 7.450581e-09      
2.384185791E-7     | 0.25               | 0.2499999963       | 1.490116e-08       | 3.725290e-09      
1.192092896E-7     | 0.25               | 0.2500000000       | 0.000000e+00       | 0.000000e+00      
5.960464478E-8     | 0.25               | 0.2500000000       | 0.000000e+00       | 0.000000e+00      
Function:  g(x) = x^(1/2) Conjugate Version
======================
h                  | exactSolution      | approx             | relError           | absError             
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
1.000000000        | 0.25               | 0.2360679775       | 5.572809e-02       | 1.393202e-02      
0.5000000000       | 0.25               | 0.2426406871       | 2.943725e-02       | 7.359313e-03      
0.2500000000       | 0.25               | 0.2462112512       | 1.515500e-02       | 3.788749e-03      
0.1250000000       | 0.25               | 0.2480768093       | 7.692763e-03       | 1.923191e-03      
0.06250000000      | 0.25               | 0.2490309932       | 3.876027e-03       | 9.690068e-04      
0.03125000000      | 0.25               | 0.2495136168       | 1.945533e-03       | 4.863832e-04      
0.01562500000      | 0.25               | 0.2497563351       | 9.746598e-04       | 2.436649e-04      
0.007812500000     | 0.25               | 0.2498780488       | 4.878050e-04       | 1.219512e-04      
0.003906250000     | 0.25               | 0.2499389946       | 2.440215e-04       | 6.100537e-05      
0.001953125000     | 0.25               | 0.2499694899       | 1.220405e-04       | 3.051013e-05      
0.0009765625000    | 0.25               | 0.2499847431       | 6.102771e-05       | 1.525693e-05      
0.0004882812500    | 0.25               | 0.2499923711       | 3.051572e-05       | 7.628929e-06      
0.0002441406250    | 0.25               | 0.2499961854       | 1.525832e-05       | 3.814581e-06      
0.0001220703125    | 0.25               | 0.2499980927       | 7.629278e-06       | 1.907320e-06      
0.00006103515625   | 0.25               | 0.2499990463       | 3.814668e-06       | 9.536670e-07      
0.00003051757813   | 0.25               | 0.2499995232       | 1.907341e-06       | 4.768353e-07      
0.00001525878906   | 0.25               | 0.2499997616       | 9.536725e-07       | 2.384181e-07      
0.000007629394531  | 0.25               | 0.2499998808       | 4.768367e-07       | 1.192092e-07      
0.000003814697266  | 0.25               | 0.2499999404       | 2.384185e-07       | 5.960462e-08      
0.000001907348633  | 0.25               | 0.2499999702       | 1.192093e-07       | 2.980232e-08      
9.536743164E-7     | 0.25               | 0.2499999851       | 5.960464e-08       | 1.490116e-08      
4.768371582E-7     | 0.25               | 0.2499999925       | 2.980232e-08       | 7.450580e-09      
2.384185791E-7     | 0.25               | 0.2499999963       | 1.490116e-08       | 3.725290e-09      
1.192092896E-7     | 0.25               | 0.2499999981       | 7.450581e-09       | 1.862645e-09      
5.960464478E-8     | 0.25               | 0.2499999991       | 3.725290e-09       | 9.313226e-10      
2.980232239E-8     | 0.25               | 0.2499999995       | 1.862645e-09       | 4.656613e-10      
1.490116119E-8     | 0.25               | 0.2499999998       | 9.313226e-10       | 2.328306e-10      
7.450580597E-9     | 0.25               | 0.2499999999       | 4.656613e-10       | 1.164153e-10      
3.725290298E-9     | 0.25               | 0.2499999999       | 2.328306e-10       | 5.820766e-11      
1.862645149E-9     | 0.25               | 0.2500000000       | 1.164153e-10       | 2.910383e-11      
9.313225746E-10    | 0.25               | 0.2500000000       | 5.820766e-11       | 1.455192e-11      
4.656612873E-10    | 0.25               | 0.2500000000       | 2.910383e-11       | 7.275958e-12      
2.328306437E-10    | 0.25               | 0.2500000000       | 1.455192e-11       | 3.637979e-12      
1.164153218E-10    | 0.25               | 0.2500000000       | 7.275958e-12       | 1.818989e-12      
5.820766091E-11    | 0.25               | 0.2500000000       | 3.637979e-12       | 9.094947e-13      
2.910383046E-11    | 0.25               | 0.2500000000       | 1.818989e-12       | 4.547474e-13      
1.455191523E-11    | 0.25               | 0.2500000000       | 9.094947e-13       | 2.273737e-13      
7.275957614E-12    | 0.25               | 0.2500000000       | 4.547474e-13       | 1.136868e-13      
3.637978807E-12    | 0.25               | 0.2500000000       | 2.273737e-13       | 5.684342e-14      
1.818989404E-12    | 0.25               | 0.2500000000       | 1.136868e-13       | 2.842171e-14      
9.094947018E-13    | 0.25               | 0.2500000000       | 5.684342e-14       | 1.421085e-14      
4.547473509E-13    | 0.25               | 0.2500000000       | 2.842171e-14       | 7.105427e-15      
2.273736754E-13    | 0.25               | 0.2500000000       | 1.421085e-14       | 3.552714e-15      
1.136868377E-13    | 0.25               | 0.2500000000       | 7.105427e-15       | 1.776357e-15      
5.684341886E-14    | 0.25               | 0.2500000000       | 3.552714e-15       | 8.881784e-16      
2.842170943E-14    | 0.25               | 0.2500000000       | 1.776357e-15       | 4.440892e-16      
1.421085472E-14    | 0.25               | 0.2500000000       | 8.881784e-16       | 2.220446e-16      
7.105427358E-15    | 0.25               | 0.2500000000       | 4.440892e-16       | 1.110223e-16      
3.552713679E-15    | 0.25               | 0.2500000000       | 2.220446e-16       | 5.551115e-17      
1.776356839E-15    | 0.25               | 0.2500000000       | 0.000000e+00       | 0.000000e+00      
8.881784197E-16    | 0.25               | 0.2500000000       | 0.000000e+00       | 0.000000e+00      
</pre>
[full code](https://KensieCarr.github.io/Math-4610/Homework2/Problem3a.py)

### b. In this problem, approximate the derivative of 
<p>
  $f(x) = \sin(x)$ at $x_0 = 0$
</p>
using the difference
<p>
  $f'(x)dx \approx \dfrac{f(x+h)-f(x)}{h}$
</p>
and use a Taylor series expansion in place of the evaluation of the sine function. Recall that 
<p>
  $\sin(0) = 0.$
</p>
Rewrite the expression and make sure the derivative is accurately approximated as *h* is taken closer to zero. What is the computational difference between the inital expression and the rewritten expression?

<p>
  $\displaystyle \sum^\infty_{n=0}(-1)^n\dfrac{x^{2n+1}}{(2n+1)!}
  
  = x - \dfrac{x^3}{3!} + \dfrac{x^5}{5!} - \dfrac{x^7}{7!} + \dfrac{x^9}{9!} - ...$
</p>
<pre>
Function:  f(x) = sin(x)
======================
h                  | exactSolution      | approx             | relError           | absError             
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
1.000000000        | 1                  | 0.8414709848       | 1.585290e-01       | 1.585290e-01      
0.5000000000       | 1                  | 0.9588510772       | 4.114892e-02       | 4.114892e-02      
0.2500000000       | 1                  | 0.9896158370       | 1.038416e-02       | 1.038416e-02      
0.1250000000       | 1                  | 0.9973978671       | 2.602133e-03       | 2.602133e-03      
0.06250000000      | 1                  | 0.9993490855       | 6.509145e-04       | 6.509145e-04      
0.03125000000      | 1                  | 0.9998372475       | 1.627525e-04       | 1.627525e-04      
0.01562500000      | 1                  | 0.9999593104       | 4.068961e-05       | 4.068961e-05      
0.007812500000     | 1                  | 0.9999898275       | 1.017249e-05       | 1.017249e-05      
0.003906250000     | 1                  | 0.9999974569       | 2.543130e-06       | 2.543130e-06      
0.001953125000     | 1                  | 0.9999993642       | 6.357828e-07       | 6.357828e-07      
0.0009765625000    | 1                  | 0.9999998411       | 1.589457e-07       | 1.589457e-07      
0.0004882812500    | 1                  | 0.9999999603       | 3.973643e-08       | 3.973643e-08      
0.0002441406250    | 1                  | 0.9999999901       | 9.934107e-09       | 9.934107e-09      
0.0001220703125    | 1                  | 0.9999999975       | 2.483527e-09       | 2.483527e-09      
0.00006103515625   | 1                  | 0.9999999994       | 6.208817e-10       | 6.208817e-10      
0.00003051757813   | 1                  | 0.9999999998       | 1.552204e-10       | 1.552204e-10      
0.00001525878906   | 1                  | 1.000000000        | 3.880507e-11       | 3.880507e-11      
0.000007629394531  | 1                  | 1.000000000        | 9.701240e-12       | 9.701240e-12      
0.000003814697266  | 1                  | 1.000000000        | 2.425282e-12       | 2.425282e-12      
0.000001907348633  | 1                  | 1.000000000        | 6.062928e-13       | 6.062928e-13      
9.536743164E-7     | 1                  | 1.000000000        | 1.515454e-13       | 1.515454e-13      
4.768371582E-7     | 1                  | 1.000000000        | 3.785861e-14       | 3.785861e-14      
2.384185791E-7     | 1                  | 1.000000000        | 9.436896e-15       | 9.436896e-15      
1.192092896E-7     | 1                  | 1.000000000        | 2.331468e-15       | 2.331468e-15      
5.960464478E-8     | 1                  | 1.000000000        | 5.551115e-16       | 5.551115e-16      
2.980232239E-8     | 1                  | 1.000000000        | 1.110223e-16       | 1.110223e-16      
1.490116119E-8     | 1                  | 1.000000000        | 0.000000e+00       | 0.000000e+00      
7.450580597E-9     | 1                  | 1.000000000        | 0.000000e+00       | 0.000000e+00      
Function:  g(x) = x - x^3/3! + x^5/5! - x^7/7! + x^9/9!
======================
h                  | exactSolution      | approx             | relError           | absError             
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
1.000000000        | 1                  | 0.8414710097       | 1.585290e-01       | 1.585290e-01      
0.5000000000       | 1                  | 0.9588510772       | 4.114892e-02       | 4.114892e-02      
0.2500000000       | 1                  | 0.9896158370       | 1.038416e-02       | 1.038416e-02      
0.1250000000       | 1                  | 0.9973978671       | 2.602133e-03       | 2.602133e-03      
0.06250000000      | 1                  | 0.9993490855       | 6.509145e-04       | 6.509145e-04      
0.03125000000      | 1                  | 0.9998372475       | 1.627525e-04       | 1.627525e-04      
0.01562500000      | 1                  | 0.9999593104       | 4.068961e-05       | 4.068961e-05      
0.007812500000     | 1                  | 0.9999898275       | 1.017249e-05       | 1.017249e-05      
0.003906250000     | 1                  | 0.9999974569       | 2.543130e-06       | 2.543130e-06      
0.001953125000     | 1                  | 0.9999993642       | 6.357828e-07       | 6.357828e-07      
0.0009765625000    | 1                  | 0.9999998411       | 1.589457e-07       | 1.589457e-07      
0.0004882812500    | 1                  | 0.9999999603       | 3.973643e-08       | 3.973643e-08      
0.0002441406250    | 1                  | 0.9999999901       | 9.934107e-09       | 9.934107e-09      
0.0001220703125    | 1                  | 0.9999999975       | 2.483527e-09       | 2.483527e-09      
0.00006103515625   | 1                  | 0.9999999994       | 6.208817e-10       | 6.208817e-10      
0.00003051757813   | 1                  | 0.9999999998       | 1.552204e-10       | 1.552204e-10      
0.00001525878906   | 1                  | 1.000000000        | 3.880507e-11       | 3.880507e-11      
0.000007629394531  | 1                  | 1.000000000        | 9.701240e-12       | 9.701240e-12      
0.000003814697266  | 1                  | 1.000000000        | 2.425282e-12       | 2.425282e-12      
0.000001907348633  | 1                  | 1.000000000        | 6.062928e-13       | 6.062928e-13      
9.536743164E-7     | 1                  | 1.000000000        | 1.515454e-13       | 1.515454e-13      
4.768371582E-7     | 1                  | 1.000000000        | 3.785861e-14       | 3.785861e-14      
2.384185791E-7     | 1                  | 1.000000000        | 9.436896e-15       | 9.436896e-15      
1.192092896E-7     | 1                  | 1.000000000        | 2.331468e-15       | 2.331468e-15      
5.960464478E-8     | 1                  | 1.000000000        | 5.551115e-16       | 5.551115e-16      
2.980232239E-8     | 1                  | 1.000000000        | 1.110223e-16       | 1.110223e-16      
1.490116119E-8     | 1                  | 1.000000000        | 0.000000e+00       | 0.000000e+00      
7.450580597E-9     | 1                  | 1.000000000        | 0.000000e+00       | 0.000000e+00      
</pre>
[full code](https://KensieCarr.github.io/Math-4610/Homework2/Problem3b.py)
